<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="light">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>US Patent Law - Section 101 (Subject Matter Eligibility) | 実務者のための知財法務</title>
<meta name="keywords" content="">
<meta name="description" content="In U.S. patent applications, many people struggle with § 101 rejection.
Of course I’m one of them.
As a personal memorandum, I’d like to leave some countermeasures to avoid § 101 rejection.
This is merely my personal opinion and should be taken as such.
Decision Flow
First, the following is the basic flow for determining patent eligibility.


     



MPEP §2106
Step 1
If the claim falls within one of the statutory categories (process, machine, manufacture, or composition of matter), then it clears the first hurdle and proceeds to Step 2A.">
<meta name="author" content="ip-note">
<link rel="canonical" href="https://ipnote.github.io/ipblog/posts/2025/08/19/223349/">
<link crossorigin="anonymous" href="/ipblog/assets/css/stylesheet.e6569abdbe17a2669f22c550c42e1125b1c78e45a7851a74793ccb69e38461c2.css" integrity="sha256-5laavb4XomafIsVQxC4RJbHHjkWnhRp0eTzLaeOEYcI=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://ipnote.github.io/assets/images/ip_favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://ipnote.github.io/assets/images/ip_favicon_16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ipnote.github.io/assets/images/ip_favicon_32.png">
<link rel="apple-touch-icon" href="https://ipnote.github.io/assets/images/ip_apple-touch-icon.png">
<link rel="mask-icon" href="https://ipnote.github.io/ipblog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://ipnote.github.io/ipblog/posts/2025/08/19/223349/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    }

</script><link rel="icon" href="/assets/images/ip_favicon.png" type="image/png">
<link rel="apple-touch-icon" href="/assets/images/ip_apple-touch-icon.png">

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4546267264299174"
     crossorigin="anonymous">
</script>

<meta name="google-site-verification" content="w6kJIjMLu9ARKIeEzLADn46AgPa-PM_tpbWMSKRzH14" />


<script async src="https://www.googletagmanager.com/gtag/js?id=G-EBRV2KGCPT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EBRV2KGCPT');
</script><meta property="og:url" content="https://ipnote.github.io/ipblog/posts/2025/08/19/223349/">
  <meta property="og:site_name" content="実務者のための知財法務">
  <meta property="og:title" content="US Patent Law - Section 101 (Subject Matter Eligibility)">
  <meta property="og:description" content="In U.S. patent applications, many people struggle with § 101 rejection.
Of course I’m one of them.
As a personal memorandum, I’d like to leave some countermeasures to avoid § 101 rejection.
This is merely my personal opinion and should be taken as such.
Decision Flow First, the following is the basic flow for determining patent eligibility.
MPEP §2106 Step 1 If the claim falls within one of the statutory categories (process, machine, manufacture, or composition of matter), then it clears the first hurdle and proceeds to Step 2A.">
  <meta property="og:locale" content="ja">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-19T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-08-19T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="US Patent Law - Section 101 (Subject Matter Eligibility)">
<meta name="twitter:description" content="In U.S. patent applications, many people struggle with § 101 rejection.
Of course I’m one of them.
As a personal memorandum, I’d like to leave some countermeasures to avoid § 101 rejection.
This is merely my personal opinion and should be taken as such.
Decision Flow
First, the following is the basic flow for determining patent eligibility.


     



MPEP §2106
Step 1
If the claim falls within one of the statutory categories (process, machine, manufacture, or composition of matter), then it clears the first hurdle and proceeds to Step 2A.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://ipnote.github.io/ipblog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "US Patent Law - Section 101 (Subject Matter Eligibility)",
      "item": "https://ipnote.github.io/ipblog/posts/2025/08/19/223349/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "US Patent Law - Section 101 (Subject Matter Eligibility)",
  "name": "US Patent Law - Section 101 (Subject Matter Eligibility)",
  "description": "In U.S. patent applications, many people struggle with § 101 rejection.\nOf course I’m one of them.\nAs a personal memorandum, I’d like to leave some countermeasures to avoid § 101 rejection.\nThis is merely my personal opinion and should be taken as such.\nDecision Flow First, the following is the basic flow for determining patent eligibility.\nMPEP §2106 Step 1 If the claim falls within one of the statutory categories (process, machine, manufacture, or composition of matter), then it clears the first hurdle and proceeds to Step 2A.\n",
  "keywords": [
    
  ],
  "articleBody": "In U.S. patent applications, many people struggle with § 101 rejection.\nOf course I’m one of them.\nAs a personal memorandum, I’d like to leave some countermeasures to avoid § 101 rejection.\nThis is merely my personal opinion and should be taken as such.\nDecision Flow First, the following is the basic flow for determining patent eligibility.\nMPEP §2106 Step 1 If the claim falls within one of the statutory categories (process, machine, manufacture, or composition of matter), then it clears the first hurdle and proceeds to Step 2A.\nIf not, it is deemed “ineligible subject matter” and the examination ends immediately.\nIn Japan, program claims are accepted, but in U.S. applications, they need to be amended into something like computer-readable medium claims.\nStep 2A In Step 2A, as shown on the right, patent eligibility is judged under the following two prongs.\nProng 1 It is determined whether the claim recites one of the judicial exceptions.\nIf not, it is considered “eligible.” If it does, then the analysis proceeds to Prong 2.\nAbstract ideas Mathematical concepts Methods of organizing human activity Mental processes Laws of nature Natural phenomena Prong 2 Even if a claim involves one of the above judicial exceptions, it is considered “eligible” if additional elements integrate the exception into a practical application.\nIf eligibility is still not recognized under Prong 2, the analysis moves on to Step 2B.\nStep 2B If the claim provides an “inventive concept”, it is deemed “eligible.”\nIf it does not, then it is “ineligible,” and the examination ends.\nThe presence of an “inventive concept” is evaluated based on whether the claim shows a technically meaningful improvement or practical utility beyond the judicial exception (for example, enhancing the functions of a particular technical field or solving a specific technical problem).\nFrom my practical experience, most of the battle against § 101 rejection happens within Step 2A (Prongs 1 and 2).\nAt least in my surroundings, I’ve never seen a case where eligibility was recognized under Step 2B. If a claim isn’t deemed eligible under Prong 2, the chances of succeeding in the more difficult Step 2B (at least in my view) are extremely low.\nFrankly, the Step 2B standard feels like it’s judged on novelty or non-obviousness factors, so it doesn’t quite make sense to me why it should be tied to patent eligibility.\nThere is, however, one hypothetical case example provided by the USPTO.\nSo, how should we argue patent eligibility?\nStrategy In Step 2A, Prong 1, abstract ideas are the major barrier—especially “mental processes,” which are particularly tricky.\nIf something can be carried out entirely in the human mind, it tends to be categorized as a mental process.\nFor example, in a hypothetical GUI case published by the USPTO, determining the frequency of icon usage over a given time period was considered, in its broadest form, to be a mental process.\nReferring to internal processing? On the other hand, if the claim specifies that a processor tracks the amount of memory allocated to each application linked with an icon, and determines icon usage over a period of time, then it is judged not to be a mental process, because it involves processor operations that cannot be performed solely in the human mind.\nHowever, such descriptions require reference to the internal operations of a device or program, which greatly undermines the detectability of infringement.\nOf course, if the inventive point lies in the internal processing itself, then it’s fine (setting aside the argument of whether it should be kept as a secret know-how instead of disclosed). But otherwise, I personally prefer not to draft claims this way.\nSo in reality, I believe the practical approach is to aim for Prong 2.\nAiming for eligibility under Prong 2 In the GUI hypothetical case, even though the step of determining icon usage was a mental process, the USPTO considered the claim eligible because it further included automatically moving the most frequently used icon to the position closest to the start icon on the GUI (an additional element beyond the mental process), thereby providing a specific improvement over prior systems.\nIn other words, even if a claim refers to an abstract idea, it can still be made eligible by claiming the actual output operation performed by the device—using the information derived from the idea in a way that leads to improvements in a specific technical problem.\nBut not just any output will suffice—the output must realistically direct to an improvement in computer functionality or in a particular technical field.\nSimply stating “outputting the result” is merely executing a general computer function, and is no different from an instruction to apply an abstract idea. So it’s important to mention more specific characteristics of the output.\nIn one real case I handled, simply adding the element of “displaying a warning” based on the obtained determination result was enough to overcome the § 101 rejection.\nPresumably, it was recognized that the warning display allowed users to quickly and easily identify situations where problems might arise in a certain technical field.\nOf course, adding a warning display element does not guarantee to avoid § 101 rejection.\nConclusion Thus, when drafting specifications, it is helpful to include not only steps for information processing but also:\nImplementation examples where the obtained information is used to produce some kind of output A description of how that output improves a technical problem By doing so, you may be able to avoid § 101 rejections while still preserving claim value.\n",
  "wordCount" : "916",
  "inLanguage": "en",
  "datePublished": "2025-08-19T00:00:00Z",
  "dateModified": "2025-08-19T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "ip-note"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ipnote.github.io/ipblog/posts/2025/08/19/223349/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "実務者のための知財法務",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ipnote.github.io/assets/images/ip_favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://ipnote.github.io/ipblog/" accesskey="h" title="実務者のための知財法務 (Alt + H)">実務者のための知財法務</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://ipnote.github.io/ipblog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://ipnote.github.io/ipblog/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://ipnote.github.io/ipblog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://ipnote.github.io/ipblog/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://ipnote.github.io/ipblog/">Home</a>&nbsp;»&nbsp;<a href="https://ipnote.github.io/ipblog/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      US Patent Law - Section 101 (Subject Matter Eligibility)
    </h1>
    <div class="post-meta"><span title='2025-08-19 00:00:00 +0000 UTC'>August 19, 2025</span>&nbsp;·&nbsp;<span>5 min</span>&nbsp;·&nbsp;<span>ip-note</span>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#Decision-Flow" aria-label="Decision Flow">Decision Flow</a></li>
                <li>
                    <a href="#Step-1" aria-label="Step 1">Step 1</a></li>
                <li>
                    <a href="#Step-2A" aria-label="Step 2A">Step 2A</a><ul>
                        
                <li>
                    <a href="#Prong-1" aria-label="Prong 1">Prong 1</a></li>
                <li>
                    <a href="#Prong-2" aria-label="Prong 2">Prong 2</a></li></ul>
                </li>
                <li>
                    <a href="#Step-2B" aria-label="Step 2B">Step 2B</a></li>
                <li>
                    <a href="#Strategy" aria-label="Strategy">Strategy</a><ul>
                        
                <li>
                    <a href="#Referring-to-internal-processing" aria-label="Referring to internal processing?">Referring to internal processing?</a></li>
                <li>
                    <a href="#Aiming-for-eligibility-under-Prong-2" aria-label="Aiming for eligibility under Prong 2">Aiming for eligibility under Prong 2</a></li></ul>
                </li>
                <li>
                    <a href="#Conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>In U.S. patent applications, many people struggle with § 101 rejection.</p>
<p>Of course I’m one of them.</p>
<p>As a personal memorandum, I’d like to leave some countermeasures to avoid § 101 rejection.</p>
<p>This is merely my personal opinion and should be taken as such.</p>
<h3 id="Decision-Flow">Decision Flow<a hidden class="anchor" aria-hidden="true" href="#Decision-Flow">#</a></h3>
<p>First, the following is the basic flow for determining patent eligibility.</p>
<div class="images-row mceNonEditable">
<figure>
    <img loading="lazy" src="image/20250524112124.png"/> 
</figure>

</div>
<div style="text-align: center;">MPEP §2106</div>
<h3 id="Step-1">Step 1<a hidden class="anchor" aria-hidden="true" href="#Step-1">#</a></h3>
<p>If the claim falls within one of the statutory categories (process, machine, manufacture, or composition of matter), then it clears the first hurdle and proceeds to Step 2A.</p>
<p>If not, it is deemed “ineligible subject matter” and the examination ends immediately.</p>
<p>In Japan, program claims are accepted, but in U.S. applications, they need to be amended into something like computer-readable medium claims.</p>
<h3 id="Step-2A">Step 2A<a hidden class="anchor" aria-hidden="true" href="#Step-2A">#</a></h3>
<p>In Step 2A, as shown on the right, patent eligibility is judged under the following two prongs.</p>
<h4 id="Prong-1">Prong 1<a hidden class="anchor" aria-hidden="true" href="#Prong-1">#</a></h4>
<p>It is determined whether the claim recites one of the judicial exceptions.</p>
<p>If not, it is considered “eligible.” If it does, then the analysis proceeds to Prong 2.</p>
<ul>
<li>Abstract ideas
<ul>
<li>Mathematical concepts</li>
<li>Methods of organizing human activity</li>
<li>Mental processes</li>
</ul>
</li>
<li>Laws of nature</li>
<li>Natural phenomena</li>
</ul>
<h4 id="Prong-2">Prong 2<a hidden class="anchor" aria-hidden="true" href="#Prong-2">#</a></h4>
<p>Even if a claim involves one of the above judicial exceptions, it is considered “eligible” if <strong>additional elements integrate the exception into a practical application</strong>.</p>
<p>If eligibility is still not recognized under Prong 2, the analysis moves on to Step 2B.</p>
<h3 id="Step-2B">Step 2B<a hidden class="anchor" aria-hidden="true" href="#Step-2B">#</a></h3>
<p>If the claim provides an “inventive concept”, it is deemed “eligible.”</p>
<p>If it does not, then it is “ineligible,” and the examination ends.</p>
<p>The presence of an “inventive concept” is evaluated based on whether the claim shows a technically meaningful improvement or practical utility beyond the judicial exception (for example, enhancing the functions of a particular technical field or solving a specific technical problem).</p>
<p>From my practical experience, most of the battle against § 101 rejection happens within Step 2A (Prongs 1 and 2).</p>
<p>At least in my surroundings, I’ve never seen a case where eligibility was recognized under Step 2B. If a claim isn’t deemed eligible under Prong 2, the chances of succeeding in the more difficult Step 2B (at least in my view) are extremely low.</p>
<p>Frankly, the Step 2B standard feels like it’s judged on novelty or non-obviousness factors, so it doesn’t quite make sense to me why it should be tied to patent eligibility.</p>
<p>There is, however, one hypothetical case example provided by the USPTO.</p>
<p>So, how should we argue patent eligibility?</p>
<h3 id="Strategy">Strategy<a hidden class="anchor" aria-hidden="true" href="#Strategy">#</a></h3>
<p>In Step 2A, Prong 1, abstract ideas are the major barrier—especially “mental processes,” which are particularly tricky.</p>
<p>If something can be carried out entirely in the human mind, it tends to be categorized as a mental process.</p>
<p>For example, in a hypothetical GUI case published by the USPTO, determining the frequency of icon usage over a given time period was considered, in its broadest form, to be a mental process.</p>
<h4 id="Referring-to-internal-processing">Referring to internal processing?<a hidden class="anchor" aria-hidden="true" href="#Referring-to-internal-processing">#</a></h4>
<p>On the other hand, if the claim specifies that a processor tracks the amount of memory allocated to each application linked with an icon, and determines icon usage over a period of time, then it is judged not to be a mental process, because it involves processor operations that cannot be performed solely in the human mind.</p>
<p>However, such descriptions require reference to the internal operations of a device or program, <strong>which greatly undermines the detectability of infringement</strong>.</p>
<p>Of course, if the inventive point lies in the internal processing itself, then it’s fine (setting aside the argument of whether it should be kept as a secret know-how instead of disclosed). But otherwise, I personally prefer not to draft claims this way.</p>
<p>So in reality, I believe the practical approach is to aim for Prong 2.</p>
<h4 id="Aiming-for-eligibility-under-Prong-2">Aiming for eligibility under Prong 2<a hidden class="anchor" aria-hidden="true" href="#Aiming-for-eligibility-under-Prong-2">#</a></h4>
<p>In the GUI hypothetical case, even though the step of determining icon usage was a mental process, the USPTO considered the claim eligible because it further included automatically moving the most frequently used icon to the position closest to the start icon on the GUI (an additional element beyond the mental process), thereby providing a specific improvement over prior systems.</p>
<p>In other words, even if a claim refers to an abstract idea, it can still be made eligible by <strong>claiming the actual output operation performed by the device—using the information derived from the idea in a way that leads to improvements in a specific technical problem</strong>.</p>
<p>But not just any output will suffice—the output must realistically direct to an improvement in computer functionality or in a particular technical field.</p>
<p>Simply stating “outputting the result” is merely executing a general computer function, and is no different from an instruction to apply an abstract idea. So it’s important to mention more specific characteristics of the output.</p>
<p>In one real case I handled, simply adding the element of “displaying a warning” based on the obtained determination result was enough to overcome the § 101 rejection.</p>
<p>Presumably, it was recognized that the warning display allowed users to quickly and easily identify situations where problems might arise in a certain technical field.</p>
<p>Of course, adding a warning display element does not guarantee to avoid § 101 rejection.</p>
<h3 id="Conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#Conclusion">#</a></h3>
<p>Thus, when drafting specifications, it is helpful to include not only steps for information processing but also:</p>
<ul>
<li>Implementation examples where the obtained information is used to produce some kind of output</li>
<li>A description of how that output improves a technical problem</li>
</ul>
<p>By doing so, you may be able to avoid § 101 rejections while still preserving claim value.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://ipnote.github.io/ipblog/posts/2025/08/20/212517/">
    <span class="title">« Prev</span>
    <br>
    <span>AIが作成したもの、特許や商標登録はOK？</span>
  </a>
  <a class="next" href="https://ipnote.github.io/ipblog/posts/2025/08/17/131248/">
    <span class="title">Next »</span>
    <br>
    <span>非常口マークなどの安全標識は勝手に使って良い？</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://ipnote.github.io/ipblog/">実務者のための知財法務</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><footer class="footer" style = "font-size:0.9rem">
  <a href="/privacy" rel="noopener" target="_blank"><strong>プライバシーポリシー/免責事項</strong></a> · 
  <a href="https://forms.gle/nEdcyw1FDb2HKvqi6" rel="noopener" target="_blank"><strong>お問い合わせ</strong></a>
  </br></br>
  当ブログはアフィリエイト広告を利用しています
</footer>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
